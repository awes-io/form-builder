/**
 * Bundle of AWES form-builder
 * Generated: 2019-04-26 16:17:48
 * Version: 1.3.22
 */

!function(){"use strict";let e=0;const t=[{type:"beforeunload",handler:"windowUnloadHandler"}];var s=function(e,t,s,i,o,r,a,l,n,d){"boolean"!=typeof a&&(n=l,l=a,a=!1);var u,c="function"==typeof s?s.options:s;if(e&&e.render&&(c.render=e.render,c.staticRenderFns=e.staticRenderFns,c._compiled=!0,o&&(c.functional=!0)),i&&(c._scopeId=i),r?(u=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,n(e)),e&&e._registeredComponents&&e._registeredComponents.add(r)},c._ssrRegister=u):t&&(u=a?function(){t.call(this,d(this.$root.$options.shadowRoot))}:function(e){t.call(this,l(e))}),u)if(c.functional){var h=c.render;c.render=function(e,t){return u.call(t),h(e,t)}}else{var m=c.beforeCreate;c.beforeCreate=m?[].concat(m,u):[u]}return s};var i=s({render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("form",{staticClass:"form-builder",class:{modal_form:e.modal},attrs:{action:e.replacedUrl,method:e.method},on:{submit:function(t){return t.preventDefault(),e.send(t)}}},[e._t("default",null,null,e.fields),e.autoSubmit?e._e():s("div",{class:e.modal?"line-btns":null},[s("div",{class:e.modal?"line-btns__wrap":"line-btns"},[s("button",{directives:[{name:"shortkey",rawName:"v-shortkey",value:["ctrl","enter"],expression:"['ctrl', 'enter']"}],staticClass:"btn btn-send has-wave",class:{"loading-inline":e.isLoading},attrs:{disabled:!e.isEdited||e.isLoading,"data-loading":e.$lang.FORMS_LOADING,type:"submit","data-awes":"modal_button_ok"},on:{shortkey:e.send}},[e._v(" "+e._s(e.sendText||e.$lang.FORMS_SEND)+" "),s("span",{staticClass:"wave"})]),e.modal||e.$listeners.cancel?s("button",e._g({directives:[{name:"shortkey",rawName:"v-shortkey",value:["esc"],expression:"['esc']"}],staticClass:"btn has-wave",class:{btn_transparent:e.$listeners.cancel},attrs:{type:"button"}},{shortkey:e.close,click:e.modal?e.close:e.$listeners.cancel}),[e._v(" "+e._s(e.cancelText||e.$lang.FORMS_CANCEL)+" "),s("span",{staticClass:"wave"})]):e._e(),e._t("buttons-after")],2)])],2)},staticRenderFns:[]},void 0,{name:"form-builder",props:{name:{type:String,default:()=>`form-builder-${e++}`},url:{type:String,required:!0},method:{type:String,default:"post",validator:e=>void 0===e||["get","put","post","delete","patch"].includes(e.toLowerCase())},default:Object,storeData:String,sendText:String,cancelText:String,loadingText:String,disabledDialog:{type:Boolean,default:!1},autoSubmit:{type:Boolean,default:!1}},inject:{modal:{from:"modal",default:!1}},provide(){return{formId:this.name,isModal:!1!==this.modal}},computed:{form(){return this.$store.state.forms[this.name]},isLoading(){return this.form&&this.form.isLoading},isEdited(){return this.form&&this.form.isEdited},fields(){return this.$store.getters["forms/fields"](this.name)},replacedUrl(){let e=this.url;if(this.form){let t=e.match(/(?!{)([\w.\[\]]+)(?=})/g);t&&t.length&&t.forEach(t=>{e=e.replace("{"+t+"}",AWES.utils.object.get(this.form.initialState,t,""))})}return e.replace(/([^:]\/)\/+/g,"$1")}},methods:{send(){!this.isLoading&&this.isEdited&&(AWES.emit(`form-builder::${this.name}:before-send`),this.$listeners.send?this.$store.dispatch("forms/restoreData",{formName:this.name}).then(e=>{this.$emit("send",e)}):this.$store.dispatch("forms/sendForm",{formName:this.name,url:this.replacedUrl,method:this.method}).then(e=>{this.$emit(e.success?"sended":"error",e.data),this.storeData&&e.success&&this.$store.$set(this.storeData,this.$get(e.data,"data",{})),this.modal&&e.success&&this.close()}))},addUnloadHandlers(){t.forEach(e=>{window.addEventListener(e.type,this[e.handler],!1)})},removeUnloadHandlers(){t.forEach(e=>{window.removeEventListener(e.type,this[e.handler])})},checkCloseAllowed(){if(this.disabledDialog)return!0;if(this.isEdited){return confirm(this.$lang.FORMS_CONFIRM)}return!0},windowUnloadHandler(e){return!(!this.disabledDialog&&this.isEdited)||(e.returnValue=this.$lang.FORMS_CONFIRM,this.$lang.FORMS_CONFIRM)},close(){this.checkCloseAllowed()&&(this.removeUnloadHandlers(),AWES.off(`modal::${this.modal.name}:before-close`,this.preventModalClose),this.modal.close())},preventModalClose(e){this.checkCloseAllowed()||e.detail.preventClose()}},created(){let e=this.storeData?this.$store.state[this.storeData]:this.default||{};this.$store.commit("forms/createForm",{formName:this.name,fields:e}),this.modal&&this.$watch("isEdited",e=>{AWES[e?"on":"off"](`modal::${this.modal.name}:before-close`,this.preventModalClose)})},mounted(){this.addUnloadHandlers(),this.autoSubmit&&this.$watch("fields",this.send,{deep:!0})},beforeDestroy(){this.removeUnloadHandlers()},destroyed(){AWES.off(`modal::${this.modal.name}:before-close`,this.preventModalClose),this.$store.commit("forms/deleteForm",this.name)}},void 0,!1,void 0,void 0,void 0);var o=s({render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-popover",{staticClass:"display-block",attrs:{placement:e.placement,open:e.open,"popover-class":["theme-error",{tooltip_modal:e.isModal}]}},[e._t("default"),e.open?s("span",{staticClass:"tooltip__text",attrs:{slot:"popover"},on:{click:function(t){return e.$emit("clickTooltip")}},slot:"popover"},[s("span",{staticClass:"errors__list"},[e._v(" "+e._s(e.errorText)+" ")])]):e._e()],2)},staticRenderFns:[]},void 0,{name:"error-wrap",inject:{isModal:{from:"isModal",default:!1}},props:{open:{type:Boolean,default:!1},placement:{type:String,default:"top"},error:{type:[String,Array]}},computed:{errorText(){return Array.isArray(this.error)?this.error.join(", "):this.error}}},void 0,!1,void 0,void 0,void 0);function r(e){return e&&e.split(/(?:\]?\.|\[(?:\'|\")?|(?:\'|\")?\])/g).filter(e=>""!==e).map(e=>e.match(/^\d+$/)?"["+e+"]":e.match(/ /)?"['"+e+"']":"."+e).join("").replace(/^\./,"")}var a={props:{name:String,id:Number,disabled:{type:Boolean,default:!1}},inject:{formId:{from:"formId",default:!1},isModal:{from:"isModal",default:!1},multiblock:{from:"multiblock",default:!1}},computed:{realName(){return this.multiblock?`${this.multiblock}[${this.id}].${r(this.name)}`:r(this.name)},formLoading(){return this.$store.getters["forms/isLoading"](this.formId)},isDisabled(){return this.formLoading||this.disabled||this.isMultiblockDisabled},isMultiblockDisabled(){return!!this.multiblock&&this.$store.getters["forms/isMultiblockDisabled"](this.formId,this.multiblock)}}};function l(e,t,s){function i(e){if(!s||0===Object.keys(s).length)return e;for(let t in s)e[t]=s[t];return e}if(document.createEvent){const s=new Event(e,{bubbles:!0,cancelable:!0});t.dispatchEvent(i(s))}else{const s=document.createEventObject();t.fireEvent("on"+e,i(s))}}var n={mixins:[a,{props:{enterSkip:{type:Boolean,default:!1},focus:{type:Boolean,default:!1}},data(){return{inFocus:this.focus}},computed:{isFocusable(){return!this.enterSkip&&!this.disabled&&this.formId}},methods:{focusNext(e){try{const t=e.target.closest("form"),s=t.querySelectorAll(".is-focusable"),i=Array.from(s).findIndex(t=>t===e.target)+1;if(i<s.length)s[i].focus();else{e.target.blur();const s=t.querySelector('[type="submit"]');this.$nextTick(()=>{s.click(),this.initWawesEffect(s)})}}catch(e){console.warn("Error while setting focus"),console.error(e)}},setFocus(e){try{let t=!1!==e?"focus":"blur";this.$refs.element[t]()}catch(e){console.warn("Error while setting focus"),console.error(e)}},initWawesEffect(e){let t={top:0,left:0};"function"==typeof e.getBoundingClientRect&&(t=e.getBoundingClientRect()),l("mousedown",e,{pageY:t.top+window.pageYOffset-document.documentElement.clientTop+e.clientHeight/2,pageX:t.left+window.pageXOffset-document.documentElement.clientLeft+e.clientWidth/2}),setTimeout(l,250,"mouseup",e)}},mounted(){this.setFocus(this.focus)}}],props:{label:String},data:()=>({showTooltip:!1,hasError:!1}),computed:{formValue:{get(){return this.$store.getters["forms/fieldValue"](this.formId,this.realName)},set(e){this.$store.commit("forms/setFieldValue",{formName:this.formId,fieldName:this.realName,value:e})}},shake(){return!this.formLoading&&this.showTooltip},error(){return this.$store.getters["forms/fieldError"](this.formId,this.realName)},firstErrorField(){return this.$store.getters["forms/firstErrorField"](this.formId)}},watch:{error:{handler(e){e?(this.showTooltip=!0,this.hasError=!0,this.checkFocus()):(this.showTooltip=!1,this.hasError=!1,this.resetInputWatcher())},immediate:!0}},methods:{initField(){this.formId&&(void 0===this.formValue?this.createStoreInstance():this.fieldValue=this.formValue),this.$root.$on("forms:reset",this.resetFormValue)},createStoreInstance(){this.$store.commit("forms/createField",{formName:this.formId,fieldName:this.realName,value:this.value})},clickTooltip(){this.showTooltip=!1,"function"==typeof this.setFocus&&this.setFocus()},resetError(){this.showTooltip=!1,this.$store.commit("forms/resetError",{formName:this.formId,fieldName:this.realName}),this.resetInputWatcher()},resetInputWatcher(){this.$refs.element&&this.$refs.element.removeEventListener("input",this.resetError)},resetFormValue(e){this.formId===e&&(this.formValue=AWES.utils.object.get(this.$options,"props.value.default"))},checkFocus(){"function"==typeof this.setFocus&&this.firstErrorField===this.realName&&(setTimeout(this.setFocus,0),this.$store.commit("resetFirstErrorField",this.formId))},destroyField(){this.$store.commit("forms/deleteField",{formName:this.formId,fieldName:this.realName}),this.resetInputWatcher(),this.$root.$off("forms:reset",this.resetFormValue)}},created(){this.initField()},destroyed(){this.destroyField()}},d={mixins:[n],props:{value:{type:String,default:""},debounce:{type:[String,Number],default:300}},computed:{isActive(){return!!(this.inFocus||this.value||this.formValue)}},methods:{formValueHandler(e){this.error?(this.formValue=e.target.value,this.resetError()):(clearTimeout(this.__debounce),this.__debounce=setTimeout(()=>{this.formValue=e.target.value},Number(this.debounce)))},vModelHandler(e){this.$emit("input",e.target.value)},save(){clearTimeout(this.__debounce),this.$refs.element&&(this.formValue=this.$refs.element.value)}},mounted(){this.formId&&AWES.on(`form-builder::${this.formId}:before-send`,this.save)},beforeDestroy(){this.formId&&AWES.off(`form-builder::${this.formId}:before-send`,this.save)}};let u=0;var c=s({render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{class:["fb-input","fb-element",{"fb-input_disabled":e.isDisabled,"fb-input_active":e.isActive||e.autoFilled,"fb-input_error":e.hasError,"animated shake":e.shake},e.$attrs.type?"fb-input_type-"+e.$attrs.type:""]},[s("fb-error-wrap",{attrs:{open:e.showTooltip,error:e.error},on:{clickTooltip:e.clickTooltip}},[s("label",{staticClass:"fb-input__label fb-input__label_field",attrs:{for:"#"+e.inputId}},[e._v(e._s(e.label))]),e.mask?s("input",e._g(e._b({directives:[{name:"mask",rawName:"v-mask",value:e.mask,expression:"mask"}],ref:"element",class:["fb-input__field",{"is-focusable":e.isFocusable},{"in-focus":e.inFocus},{"fb-input__field_password":"password"===e.$attrs.type}],attrs:{id:e.inputId,"data-awes":e.$options.name+"."+e.name,type:e.inputType,disabled:e.isDisabled},domProps:{value:e.formId?e.formValue:e.value},on:{focus:function(t){e.inFocus=!0},blur:function(t){e.save(),e.inFocus=!1},keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.focusNext(t))},animationstart:e.autoFillHack}},"input",e.$attrs,!1),{input:e.formId?e.formValueHandler:e.vModelHandler})):s("input",e._g(e._b({ref:"element",class:["fb-input__field",{"is-focusable":e.isFocusable},{"in-focus":e.inFocus},{"fb-input__field_password":"password"===e.$attrs.type}],attrs:{id:e.inputId,"data-awes":e.$options.name+"."+e.name,type:e.inputType,disabled:e.isDisabled},domProps:{value:e.formId?e.formValue:e.value},on:{focus:function(t){e.inFocus=!0},blur:function(t){e.save(),e.inFocus=!1},keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.focusNext(t))},animationstart:e.autoFillHack}},"input",e.$attrs,!1),{input:e.formId?e.formValueHandler:e.vModelHandler})),"password"===e.$attrs.type?s("button",{staticClass:"fb-input__eye",attrs:{type:"button",tabindex:"-1","aria-label":e.$lang.SHOW_PASSWORD},on:{click:function(t){return t.preventDefault(),e.togglePassword(t)}}},[s("i",{class:["icon","password"===e.inputType?"icon-eye":"icon-eye2"]})]):e._e()])],1)},staticRenderFns:[]},void 0,{name:"fb-input",inheritAttrs:!1,mixins:[d],props:{label:{type:String,default:""},mask:String},data(){return{inputType:this.$attrs.type||"text",autoFilled:!1}},computed:{inputId:()=>"input-"+u++},methods:{togglePassword(){this.setFocus(),"password"===this.inputType?this.inputType="text":this.inputType="password"},autoFillHack(e){switch(e.animationName){case"autoFillStart":this.autoFilled=!0;break;case"autoFillEnd":this.autoFilled=!1}}}},void 0,!1,void 0,void 0,void 0);var h=s({render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"fb-multiblock fb-element",class:[{"fb-multiblock_disabled":this.isDisabled}]},[e._l(e.blocks,function(t){return s("div",{key:t,class:["fb-multiblock__block",{"fb-multiblock_has-close":e.hasClose}]},[e._t("default",null,{id:t}),e.hasClose?s("button",{staticClass:"fb-multiblock__clear",attrs:{"aria-label":"delete"},on:{click:function(s){return s.preventDefault(),e.removeField(t)}}},[s("i",{staticClass:"icon icon-cross"})]):e._e()],2)}),s("button",{staticClass:"fb-multiblock__add",on:{click:function(t){return t.preventDefault(),e.addField(t)}}},[e._v(" "+e._s(e.label||e.$lang.FORMS_MULTIBLOCK_ADD)+" ")])],2)},staticRenderFns:[]},void 0,{name:"fb-multi-block",mixins:[a],props:{label:String},provide(){return{multiblock:this.realName,nextIndex:0}},computed:{blocks(){return this.$store.getters["forms/multiblockIds"](this.formId,this.name)},hasClose(){return this.blocks.length>1},errors(){return this.$store.getters["forms/errorsOrFalse"](this.formId)},fields(){return this.$options}},watch:{disabled(e){this.$store.commit("forms/toggleMultiblockState",{formName:this.formId,multiblockName:this.realName,status:e})}},methods:{addField(){this.isDisabled||(this.$store.commit("forms/addMultiblockId",{formName:this.formId,multiblockName:this.name,id:this.nextIndex++}),this.updateTooltips())},removeField(e){this.isDisabled||(this.$store.commit("forms/deleteMultiblockId",{formName:this.formId,multiblockName:this.name,id:e}),this.updateTooltips())},updateTooltips(){this.errors&&this.$nextTick(()=>{l("scroll",window)})},initMultiblock(){this.$store.commit("forms/createMutiblock",{formName:this.formId,multiblockName:this.realName,disabled:this.disabled}),this.nextIndex=Math.max.apply(null,this.blocks)+1},destroyMultiblock(){this.$store.commit("forms/deleteMultiblock",{formName:this.formId,multiblockName:this.realName})}},created(){this.initMultiblock()},destroyed(){this.destroyMultiblock()}},void 0,!1,void 0,void 0,void 0),m={mixins:[n],props:{value:{type:[Boolean,Number,Array],default:0},defaultValue:String,label:{type:String,required:!0}},data:()=>({isNumeric:!0}),computed:{isActive(){return!!(this.formId?this.formValue:this.vModelChecked)},vModelArray(){return!this.formId&&Array.isArray(this.value)},vModelChecked(){return this.vModelArray?this.value.includes(this.computedValue):this.value},computedValue(){return this.defaultValue||this.label.replace(/ /g,"_").toLowerCase()}},created(){this.formId&&"boolean"==typeof this.formValue&&(this.isNumeric=!1)}};var f=s({render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{class:["fb-checkbox","fb-element",{"fb-checkbox_error":e.hasError},{"fb-checkbox_active":e.isActive},{"fb-checkbox_disabled":e.isDisabled}]},[s("label",{staticClass:"fb-checkbox__label",attrs:{"data-awes":e.$options.name+"."+e.name}},[s("fb-error-wrap",{attrs:{open:e.showTooltip,error:e.error},on:{clickTooltip:e.clickTooltip}},[s("input",e._g(e._b({ref:"element",class:{"is-focusable":e.isFocusable,"in-focus":e.inFocus},attrs:{type:"checkbox",disabled:e.isDisabled},domProps:{value:e.computedValue,checked:e.formId?e.formValue:e.vModelChecked},on:{focus:function(t){e.inFocus=!0},blur:function(t){e.inFocus=!1},keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.focusNext(t))}}},"input",e.$attrs,!1),{change:e.formId?e.formValueHandler:e.vModelHandler})),s("span",{staticClass:"fb-checkbox__text"},[s("i",{staticClass:"icon icon-checkbox"}),s("span",[e._v(e._s(e.label))])])])],1)])},staticRenderFns:[]},void 0,{name:"fb-checkbox",inheritAttrs:!1,mixins:[m],methods:{formValueHandler(e){let t=e.target.checked;this.formValue=this.isNumeric?Number(t):t,this.error&&this.resetError()},vModelHandler(e){let t;this.vModelArray?(t=this.value.slice(),e.target.checked&&!this.vModelChecked?t.push(this.computedValue):!e.target.checked&&this.vModelChecked&&t.splice(t.findIndex(e=>e===this.computedValue),1)):t=e.target.checked,this.$emit("input",t)}}},void 0,!1,void 0,void 0,void 0);let p=20;var b=s({render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"fb-select fb-element",class:[{"fb-select_active":e.isActive},{"fb-select_opened":e.isOpened},{"fb-select_disabled":e.disabled}]},[s("fb-error-wrap",{attrs:{open:e.showTooltip,error:e.error},on:{clickTooltip:e.clickTooltip}},[s("span",{staticClass:"fb-select__label"},[e._v(e._s(e.label||e.$lang.FORMS_SELECT_LABEL))]),s("multiselect",e._g({ref:"select",staticClass:"fb-select__field",attrs:{taggable:e.taggable,"show-labels":!1,multiple:e.multiple,"hide-selected":e.multiple,placeholder:e.placeholderText||e.defaultPlaceholder,"tag-placeholder":e.$lang.FORMS_SELECT_ADD_TAG,"internal-search":!e.isAjax,loading:e.isLoading,value:e.formId?e.convertValue(e.formValue):e.value,options:e.usedOptions,label:e.optionsName,"track-by":e.optionsValue,disabled:e.isDisabled},on:{open:function(t){e.isOpened=!0},close:function(t){e.isOpened=!1},tag:e.addOption}},{input:e.formId?e.formValueHandler:e.vModelHandler}),[s("template",{slot:"noOptions"},[e._v(e._s(e.$lang.FORMS_SELECT_EMPTY))])],2)],1)],1)},staticRenderFns:[]},void 0,{name:"fb-select",mixins:[n],components:{Multiselect:e=>{AWES.utils.loadModules({"vue-multiselect":{src:["https://unpkg.com/vue-multiselect@2.1.3/dist/vue-multiselect.min.js","https://unpkg.com/vue-multiselect@2.1.3/dist/vue-multiselect.min.css"],deps:["vue"],cb(){e(window.VueMultiselect.default)}}})}},props:{value:{},selectOptions:{type:[String,Array],default:()=>[]},optionsName:{type:String,default:"name"},optionsValue:{type:String,default:"value"},multiple:{type:Boolean,default:!0},taggable:{type:Boolean,default:!1},debounce:{type:[String,Number],default:1e3},autoFetch:{type:[String,Boolean],default:!1},placeholderText:String},data:()=>({isOpened:!1,isLoading:!1,ajaxOptions:[],addedOptions:[]}),computed:{computedValue(){return this.formId?this.formValue:this.value},hasValue(){return!!(this.multiple?this.computedValue&&this.computedValue.length:this.computedValue)},isActive(){return this.isOpened||this.hasValue},isAjax(){return"string"==typeof this.selectOptions},defaultPlaceholder(){return this.$lang[this.isAjax?"FORMS_SELECT_AJAX_PLACEHOLDER":"FORMS_SELECT_PLACEHOLDER"]},usedOptions(){let e=this.isAjax?this.ajaxOptions:this.selectOptions;return this.filterValue(this.addedOptions,e).concat(e)}},methods:{formValueHandler(e){e&&(this.formValue=this.multiple?e.map(e=>e[this.optionsValue]).sort():e[this.optionsValue],this.error&&this.resetError())},vModelHandler(e){e&&this.$emit("input",e)},convertValue(e){return this.multiple?Array.isArray(e)?this.usedOptions.filter(t=>e.includes(t[this.optionsValue])):this.usedOptions.filter(t=>e===t[this.optionsValue]):this.usedOptions.find(t=>e===t[this.optionsValue])},filterValue(e,t){return e.filter(e=>{return-1===t.findIndex(t=>t[this.optionsName]===e[this.optionsName]&&t[this.optionsValue]===e[this.optionsValue])})},resetFormValue(e){this.formId===e&&(this.formValue=this.multiple?[]:void 0)},setFocus(e){try{let t=!1!==e?"focus":"blur";this.$refs.select.$el[t]()}catch(t){--p&&setTimeout(this.setFocus,1e3,e)}},addOption(e){let t,s={};s[this.optionsName]=e,s[this.optionsValue]=e,this.addedOptions.push(s),t=this.multiple?[s].concat(this.$refs.select.value):s,this.formId?this.formValueHandler(t):this.vModelHandler(t)},wrapTabEvents(){try{this.$refs.select.$el.querySelector(".multiselect__input").classList.add("is-focusable")}catch(e){--p&&setTimeout(this.wrapTabEvents,500)}},bindSearch(){try{if(this.isAjax&&(this.$refs.select.$on("search-change",this.ajaxSearch),this.$refs.select.$once("hook:destroyed",()=>{this.$refs.select.$off("search-change",this.ajaxSearch)}),"false"!==this.autoFetch.toString())){let e="string"==typeof this.autoFetch?this.autoFetch:"";this.ajaxSearch(e,!0)}}catch(e){p&&setTimeout(this.bindSearch,500)}},ajaxSearch(e,t){(e||t)&&(clearTimeout(this.__search),this.isLoading=!0,this.__search=setTimeout(()=>{AWES.ajax({},this.selectOptions.replace("%s",e),"get").then(e=>{let t=[];if(!0===e.success&&(Array.isArray(e.data)?t=e.data:e.data&&Array.isArray(e.data.data)&&(t=e.data.data)),this.multiple&&this.hasValue){let e=this.convertValue(this.computedValue);t=(e=this.filterValue(e,t)).concat(t)}this.ajaxOptions=t,this.isLoading=!1})},Number(this.debounce)))}},mounted(){this.$nextTick(this.wrapTabEvents),this.$nextTick(this.bindSearch)}},void 0,!1,void 0,void 0,void 0);"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var v,_=(function(e,t){!function(e,t){var s,i,o="function"==typeof Map?new Map:(s=[],i=[],{has:function(e){return s.indexOf(e)>-1},get:function(e){return i[s.indexOf(e)]},set:function(e,t){-1===s.indexOf(e)&&(s.push(e),i.push(t))},delete:function(e){var t=s.indexOf(e);t>-1&&(s.splice(t,1),i.splice(t,1))}}),r=function(e){return new Event(e,{bubbles:!0})};try{new Event("test")}catch(e){r=function(e){var t=document.createEvent("Event");return t.initEvent(e,!0,!1),t}}function a(e){if(e&&e.nodeName&&"TEXTAREA"===e.nodeName&&!o.has(e)){var t=null,s=null,i=null,a=function(){e.clientWidth!==s&&c()},l=function(t){window.removeEventListener("resize",a,!1),e.removeEventListener("input",c,!1),e.removeEventListener("keyup",c,!1),e.removeEventListener("autosize:destroy",l,!1),e.removeEventListener("autosize:update",c,!1),Object.keys(t).forEach(function(s){e.style[s]=t[s]}),o.delete(e)}.bind(e,{height:e.style.height,resize:e.style.resize,overflowY:e.style.overflowY,overflowX:e.style.overflowX,wordWrap:e.style.wordWrap});e.addEventListener("autosize:destroy",l,!1),"onpropertychange"in e&&"oninput"in e&&e.addEventListener("keyup",c,!1),window.addEventListener("resize",a,!1),e.addEventListener("input",c,!1),e.addEventListener("autosize:update",c,!1),e.style.overflowX="hidden",e.style.wordWrap="break-word",o.set(e,{destroy:l,update:c}),"vertical"===(n=window.getComputedStyle(e,null)).resize?e.style.resize="none":"both"===n.resize&&(e.style.resize="horizontal"),t="content-box"===n.boxSizing?-(parseFloat(n.paddingTop)+parseFloat(n.paddingBottom)):parseFloat(n.borderTopWidth)+parseFloat(n.borderBottomWidth),isNaN(t)&&(t=0),c()}var n;function d(t){var s=e.style.width;e.style.width="0px",e.offsetWidth,e.style.width=s,e.style.overflowY=t}function u(){if(0!==e.scrollHeight){var i=function(e){for(var t=[];e&&e.parentNode&&e.parentNode instanceof Element;)e.parentNode.scrollTop&&t.push({node:e.parentNode,scrollTop:e.parentNode.scrollTop}),e=e.parentNode;return t}(e),o=document.documentElement&&document.documentElement.scrollTop;e.style.height="",e.style.height=e.scrollHeight+t+"px",s=e.clientWidth,i.forEach(function(e){e.node.scrollTop=e.scrollTop}),o&&(document.documentElement.scrollTop=o)}}function c(){u();var t=Math.round(parseFloat(e.style.height)),s=window.getComputedStyle(e,null),o="content-box"===s.boxSizing?Math.round(parseFloat(s.height)):e.offsetHeight;if(o<t?"hidden"===s.overflowY&&(d("scroll"),u(),o="content-box"===s.boxSizing?Math.round(parseFloat(window.getComputedStyle(e,null).height)):e.offsetHeight):"hidden"!==s.overflowY&&(d("hidden"),u(),o="content-box"===s.boxSizing?Math.round(parseFloat(window.getComputedStyle(e,null).height)):e.offsetHeight),i!==o){i=o;var a=r("autosize:resized");try{e.dispatchEvent(a)}catch(e){}}}}function l(e){var t=o.get(e);t&&t.destroy()}function n(e){var t=o.get(e);t&&t.update()}var d=null;"undefined"==typeof window||"function"!=typeof window.getComputedStyle?((d=function(e){return e}).destroy=function(e){return e},d.update=function(e){return e}):((d=function(e,t){return e&&Array.prototype.forEach.call(e.length?e:[e],function(e){return a(e)}),e}).destroy=function(e){return e&&Array.prototype.forEach.call(e.length?e:[e],l),e},d.update=function(e){return e&&Array.prototype.forEach.call(e.length?e:[e],n),e}),t.default=d,e.exports=t.default}(e,t)}(v={exports:{}},v.exports),v.exports);let g=0;var y=s({render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"fb-textarea fb-element",class:{"fb-textarea_disabled":e.isDisabled,"fb-textarea_active":e.isActive,"fb-textarea_error":e.hasError,"animated shake":e.shake}},[s("fb-error-wrap",{attrs:{open:e.showTooltip,error:e.error},on:{clickTooltip:e.clickTooltip}},[s("label",{staticClass:"fb-textarea__label",attrs:{for:e.textareaId}},[e._v(e._s(e.label))]),s("textarea",e._g(e._b({ref:"element",class:["fb-textarea__field",{"is-focusable":e.isFocusable},{"in-focus":e.inFocus}],attrs:{id:e.textareaId,disabled:e.isDisabled},domProps:{value:e.formId?e.formValue:e.value},on:{focus:function(t){e.inFocus=!0},blur:function(t){e.save(),e.inFocus=!1}}},"textarea",e.$attrs,!1),{input:e.formId?e.formValueHandler:e.vModelHandler}))])],1)},staticRenderFns:[]},void 0,{name:"fb-textarea",inheritAttrs:!1,mixins:[d],props:{fixsize:{type:Boolean,default:!1}},computed:{textareaId:()=>"textarea-"+g++},methods:{setAutoResize(){this.fixsize||(_(this.$refs.element),this.$watch("value",this.updateAutoResize))},updateAutoResize(){this.$nextTick(()=>{_.update(this.$refs.element)})}},mounted(){this.setAutoResize()}},void 0,!1,void 0,void 0,void 0);var k=s({render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{class:["fb-keycode","fb-element",{"animated shake":e.shake},{"fb-keycode_disabled":e.isDisabled}]},[s("div",{staticClass:"fb-keycode__block"},[s("fb-error-wrap",{attrs:{open:e.showTooltip,error:e.error},on:{clickTooltip:e.clickTooltip}},[s("div",{staticClass:"fb-keycode__wrap",attrs:{id:"keywrap"}},e._l(e.length,function(t){return s("div",{key:t,staticClass:"fb-keycode__field-wrap"},[s("input",{ref:"fields",refInFor:!0,class:["fb-keycode__field",{"is-focusable":e.isFocusable,"in-focus":e.inFocus[t-1]}],attrs:{type:"tel",inputmode:"numeric",pattern:"[0-9]*",maxlength:"1",autocomplete:"off",disabled:e.isDisabled},domProps:{value:e.inputValue[t-1]},on:{focus:function(s){e.inFocus[t-1]=!0},blur:function(s){e.inFocus[t-1]=!1},keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.focusNext(t))},function(s){if(!s.type.indexOf("key")&&e._k(s.keyCode,"backspace",void 0,s.key,void 0))return null;t>1&&e.onBackspace(s,t-1)},function(s){return!s.type.indexOf("key")&&e._k(s.keyCode,"left",37,s.key,["Left","ArrowLeft"])?null:"button"in s&&0!==s.button?null:void(t>1&&e.onLeft(s,t-1))},function(s){return!s.type.indexOf("key")&&e._k(s.keyCode,"right",39,s.key,["Right","ArrowRight"])?null:"button"in s&&2!==s.button?null:void(t<e.length&&e.onRight(s,t-1))}],input:function(s){return e.onInput(s,t-1)},paste:function(t){return t.preventDefault(),e.onPaste(t)}}})])}),0)])],1)])},staticRenderFns:[]},void 0,{name:"fb-code",mixins:[n],props:{length:{type:Number,default:6}},data:()=>({inputValue:[],inFocus:[]}),computed:{value:{get(){return this.inputValue.join("")},set(e){e=e.trim().replace(/\D/g,"").substr(0,this.length),this.inputValue=e.split("")}}},watch:{error(e){e&&e.length?(this.value="",this.$refs.fields.forEach(e=>{e.addEventListener("input",this.resetError,!1)}),this.$nextTick(()=>{this.setFocus()})):this.$refs.fields.forEach(e=>{e.removeEventListener("input",this.resetError)})},value(e){e.length===this.length&&(this.formValue=e)},formValue(e){e!==this.value&&(this.value=e,this.setFocus(e.length))}},methods:{setFocus(e=0){if("boolean"==typeof e&&!0===e)return void this.$refs.fields[0].focus();if("number"!=typeof e)return;e>=this.length&&(e=this.length-1);const t=this.$refs.fields[e];setTimeout(()=>{t.focus(),t.setSelectionRange(0,t.value.length)},10)},onInput(e,t){const s=e.target.value.replace(/\D/g,"");e.target.value=s,this.$set(this.inputValue,t,s),this.isEmpty(t)||t===this.length-1||this.setFocus(t+1)},onBackspace(e,t){this.setFocus(t-1)},onLeft(e,t){this.setFocus(t-1)},onRight(e,t){this.setFocus(t+1)},onPaste(e){this.error&&this.error.length&&this.resetError(),this.value=e.clipboardData.getData("text")},isEmpty(e){return""===this.inputValue[e]||void 0===this.inputValue[e]}},created(){for(let e=0;e<this.length;e++)this.inFocus.push(!(0!==e||!this.focus)),this.inputValue.push("")},beforeDestroy(){this.$refs.fields.forEach(e=>{e.removeEventListener("input",this.resetError)})}},void 0,!1,void 0,void 0,void 0),E={domain:"awescrm.de",maxlength:32,ulrifyOptions:{spaces:"-",toLower:!0,trim:!0,addEToUmlauts:!0,nonPrintable:"",failureOutput:""}};var F=s({render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{class:["fb-slug","fb-element",{"fb-slug_disabled":e.isDisabled,"fb-slug_active":e.isActive,"fb-slug_error":e.hasError,"animated shake":e.shake}]},[s("fb-error-wrap",{attrs:{open:e.showTooltip,error:e.error},on:{clickTooltip:e.clickTooltip}},[s("div",{staticClass:"fb-slug__group-wrap"},[s("span",{staticClass:"fb-slug__group-field"},[s("label",{staticClass:"fb-slug__label",attrs:{for:"#"+e.inputId}},[e._v(e._s(e.label))]),s("input",e._g(e._b({ref:"element",class:["fb-slug__field",{"is-focusable":e.isFocusable},{"in-focus":e.inFocus}],attrs:{id:e.inputId,"data-awes":e.$options.name+"."+e.name,maxlength:e.maxlength,type:"text",disabled:e.isDisabled},domProps:{value:e.formId?e.formValue:e.removeDomain(e.value)},on:{input:e.toggleWatcher,focus:function(t){e.inFocus=!0},blur:function(t){e.save(),e.inFocus=!1},keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.focusNext(t))}}},"input",e.$attrs,!1),{input:e.formId?e.formValueHandler:e.vModelHandler}))]),s("span",{staticClass:"fb-slug__group-label"},[e._v(e._s(e.dotDomain))])])])],1)},staticRenderFns:[]},void 0,{name:"fb-company-slug",extends:c,props:{domain:{type:String,default(){return this._config.domain}},debounce:{type:[String,Number],default:0},input:{type:String,default:""},maxlength:{type:[String,Number],default(){return this._config.maxlength}}},data:()=>({watchInput:!0}),computed:{dotDomain(){return"."+this.domain.replace(/^\./,"")},formValue:{get(){return this.removeDomain(this.$store.getters["forms/fieldValue"](this.formId,this.realName))},set(e){this.$store.commit("forms/setFieldValue",{formName:this.formId,fieldName:this.realName,value:this.addDomain(this.noramlizeUrl(e))})}}},watch:{input:{handler(e){!this.$isServer&&this.watchInput&&e&&(this.formId?this._isMounted?this.formValue=e:this.$nextTick(()=>this.formValue=e):this.vModelHandler({target:{value:e}}))},immediate:!0}},methods:{vModelHandler(e){this.$emit("input",this.addDomain(this.noramlizeUrl(e.target.value)))},toggleWatcher(e){""===e.target.value?this.watchInput=!0:this.watchInput&&(this.watchInput=!1)},noramlizeUrl(e){return e&&this.$toUrl(e).substr(0,+this.maxlength)},addDomain(e){return e&&this.removeDomain(e)+this.dotDomain},removeDomain(e){return e&&e.replace(this.dotDomain,"")}},beforeCreate(){this._config=Object.assign({},E,window.AWES._config.companySlug),this.$toUrl=Urlify.create(this._config.ulrifyOptions)}},void 0,!1,void 0,void 0,void 0);var w=s({render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.isShow&&!e.reset?s("div",[s("fb-error-wrap",{attrs:{open:e.showTooltip,error:e.error},on:{clickTooltip:function(t){e.showTooltip=!1}}},[s("vue-recaptcha",e._g({ref:"recaptcha",staticClass:"re-captcha",attrs:{sitekey:e.sitekey,theme:e.theme}},{verify:e.formId?e.onVerify:null,expired:e.formId?e.onExpired:null}))],1)],1):e._e()},staticRenderFns:[]},void 0,{name:"fb-auto-captcha",mixins:[a],components:{vueRecaptcha:e=>AWES.utils.loadModule("vue-recaptcha","https://unpkg.com/vue-recaptcha@latest/dist/vue-recaptcha.min.js",()=>{e(window.VueRecaptcha)})},props:{show:{type:Boolean,default:!1}},data:()=>({sitekey:AWES._config.reCaptchaSiteKey,serverError:!1,showTooltip:!1,reset:!1,theme:AWES._themeDark?"dark":"light"}),computed:{formValue:{get(){return this.$store.getters["forms/fieldValue"](this.formId,this.realName)},set(e){this.$store.commit("forms/setFieldValue",{formName:this.formId,fieldName:this.realName,value:e})}},error(){return this.$store.getters["forms/fieldError"](this.formId,this.realName)},realName:()=>"g-recaptcha-response",isShow(){return this.show||this.serverError}},watch:{error(e){(Array.isArray(e)&&e.length||e)&&(this.serverError=!0)},formLoading(e){!e&&this.isShow&&this.$nextTick(()=>{this.$refs.recaptcha.reset()})},theme(){this.isShow&&(this.reset=!0,this.$nextTick(()=>{this.reset=!1}))}},methods:{onVerify(e){this.formValue=e,this.resetError()},onExpired(){this.formValue=null},checkTheme({detail:e}){this.theme=e?"dark":"light"},resetError(){this.showTooltip=!1,this.$store.commit("forms/resetError",{formName:this.formId,fieldName:this.realName})},manageCaptchaScript(e){switch(e){case"add":if(!document.getElementById("g-captcha-script")){const e=document.createElement("script");e.setAttribute("id","g-captcha-script"),e.setAttribute("src","https://www.google.com/recaptcha/api.js?onload=vueRecaptchaApiLoaded&render=explicit"),document.head.appendChild(e)}break;case"remove":document.getElementById("g-captcha-script").remove()}}},created(){this.$isServer||(this.manageCaptchaScript("add"),AWES.on("theme.change",this.checkTheme))},beforeDestroy(){this.manageCaptchaScript("remove"),AWES.off("theme.change",this.checkTheme)}},void 0,!1,void 0,void 0,void 0);var S=s({render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.items&&e.items.length?s("div",{staticClass:"fc-radio fb-element",class:{"animated shake":e.shake}},[e.label?s("div",{staticClass:"fc-radio__label"},[e._v(e._s(e.label))]):e._e(),s("fb-error-wrap",{attrs:{open:e.showTooltip,error:e.error},on:{clickTooltip:e.clickTooltip}},[s("div",{staticClass:"fc-radio__wrap"},e._l(e.items,function(t,i){return s("label",{key:i,class:["fc-radio__box",{"is-checked":e.checkActive(t),"fc-radio_disabled":e.isItemDisabled(t)}]},[s("input",e._g(e._b({ref:"fields",refInFor:!0,class:["fc-radio__field",{"is-focusable":e.isFocusable},{"in-focus":e.inFocus}],attrs:{type:"radio","data-awes":e.$options.name+"."+e.name,disabled:e.isItemDisabled(t)},domProps:{checked:e.checkActive(t),value:t.value?t.value:t.toString()},on:{focus:function(t){return e.$set(e.inFocus,i,!0)},blur:function(t){return e.$set(e.inFocus,i,!1)},keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.focusNext(t))}}},"input",e.$attrs,!1),{input:e.formId?e.formValueHandler:e.vModelHandler})),e._t("default",[s("span",{staticClass:"fc-radio__text"},[e._v(e._s(t.name?t.name:t.toString()))])],{item:t,checked:e.checkActive(t),focused:e.inFocus[i]})],2)}),0)])],1):e._e()},staticRenderFns:[]},void 0,{name:"fb-radio-group",mixins:[n],props:{items:Array,value:String,disabled:{type:[String,Boolean],default:!1}},data:()=>({inFocus:[]}),computed:{disabledItems(){return"boolean"==typeof this.disabled&&this.disabled||""===this.disabled?this.items.map(e=>e.value):"string"==typeof this.disabled?this.disabled.split(",").map(e=>e.trim()):[]}},methods:{isItemDisabled(e){return this.disabledItems.indexOf(e.value)>-1},formValueHandler(e){this.formValue=e.target.value,this.error&&this.resetError()},vModelHandler(e){this.$emit("input",e.target.value)},checkActive(e){return this.getItemValue(e)==(this.formId?this.formValue:this.value)},getItemValue:e=>e.value?e.value:e.toString(),setFocus(e=!0){"number"==typeof e?this.$refs.elements[e].focus():!0===e&&this.$refs.elements[0].focus()}},created(){for(let e=0;e<this.items.length;e++)this.inFocus.push(!(0!==e||!this.focus))}},void 0,!1,void 0,void 0,void 0);let x=0;var $=s({render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{class:["fb-slider","fb-element",{"fb-slider_disabled":e.isDisabled,"fb-slider_error":e.hasError,"animated shake":e.shake}]},[s("fb-error-wrap",{attrs:{open:e.showTooltip,error:e.error},on:{clickTooltip:e.clickTooltip}},[s("div",{staticClass:"fb-slider__wrap"},[s("div",{staticClass:"fb-slider__wrap-left"},[s("label",{staticClass:"fb-slider__label",attrs:{for:"#"+e.inputId}},[e._v(e._s(e.label))]),s("span",{staticClass:"fb-slider__value"},[e._v(e._s(e.percent)+" %")])]),s("div",{staticClass:"fb-slider__wrap-right"},[s("input",e._b({ref:"element",class:["fb-slider__field",{"is-focusable":e.isFocusable},{"in-focus":e.inFocus}],style:"--percent: "+e.percent+"%",attrs:{id:e.inputId,"data-awes":e.$options.name+"."+e.name,type:"range",disabled:e.isDisabled},domProps:{value:(e.formId?e.formValue:e.value)||0},on:{focus:function(t){e.inFocus=!0},blur:function(t){e.inFocus=!1},keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.focusNext(t))}}},"input",e.$attrs,!1))])])])],1)},staticRenderFns:[]},void 0,{name:"fb-slider",inheritAttrs:!1,mixins:[n],props:{min:{type:[Number,String],default:0},max:{type:[Number,String],default:100},value:{type:[Number,String],default:0}},computed:{inputId:()=>"slider-"+x++,percent(){return Math.round(Number(this.formId?this.formValue:this.value)||0/Number(this.max)*100)}},methods:{formValueHandler(e){this.formValue=Number(e.target.value),this.error&&this.resetError()},vModelHandler(e){this.$emit("input",Number(e.target.value))},toggleListener(e){let t=(e?"add":"remove")+"EventListener",s=this.formId?this.formValueHandler:this.vModelHandler,i=window.MSInputMethodContext?"change":"input";this.$refs.element[t](i,s)}},mounted(){this.$nextTick(()=>this.toggleListener(!0))},beforeDestroy(){this.toggleListener(!1)}},void 0,!1,void 0,void 0,void 0);let V=20;var C=s({render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{class:["fb-phone","fb-element",{"fb-phone_disabled":e.isDisabled,"animated shake":e.shake,"fb-phone_active":e.isActive,"fb-phone_error":e.hasError}]},[s("fb-error-wrap",{attrs:{open:e.showTooltip,error:e.error},on:{clickTooltip:e.clickTooltip}},[s("span",{staticClass:"fb-phone__label"},[e._v(e._s(e.label))]),s("vue-tel-input",e._g({ref:"tel",attrs:{value:e.formId?e.formValue:e.value,disabled:e.isDisabled},on:{onBlur:function(t){e.save(),e.inFocus=!1},onInput:e.checkFocus}},{input:e.formId?e.formValueHandler:e.vModelHandler}))],1)],1)},staticRenderFns:[]},void 0,{name:"fb-phone",mixins:[n],components:{VueTelInput:e=>{return AWES.utils.loadModule("vue-tel-input",["https://unpkg.com/vue-tel-input@2.0.13/dist/vue-tel-input.js","https://unpkg.com/vue-tel-input@2.0.13/dist/vue-tel-input.css"],()=>{e(VueTelInput.default)})}},props:{value:{type:String,default:""},debounce:{type:[String,Number],default:300}},data:()=>({nativeTelInput:!1}),computed:{isActive(){return!!(this.inFocus||this.value||this.formValue)}},methods:{formValueHandler(e){this.error?(this.formValue=e,this.resetError()):(clearTimeout(this.__debounce),this.__debounce=setTimeout(()=>{this.formValue=e},Number(this.debounce)))},vModelHandler(e){this.$emit("input",e)},setFocusWatcher(){this.$refs.tel&&(this.nativeTelInput=this.$refs.tel.$refs.input,this.nativeTelInput.addEventListener("focus",()=>{this.inFocus=!0}),this.setFocusableClass(),this.setFocusClass())},setFocusClass(){this.nativeTelInput.classList[this.inFocus?"add":"remove"]("in-focus"),V=20},setFocusableClass(){this.nativeTelInput.classList[this.isFocusable?"add":"remove"]("is-focusable"),V=20},setFocus(e){try{let t=!1!==e?"focus":"blur";this.nativeTelInput[t]()}catch(t){V&&(V--,setTimeout(()=>{this.setFocus(e)},1e3))}},checkFocus(){this.inFocus||this.setFocus()},save(){clearTimeout(this.__debounce),this.formValue=this.nativeTelInput.value}},watch:{inFocus(){try{this.setFocusClass()}catch(e){V&&(V--,setTimeout(this.setFocusClass,1e3))}},isFocusable(){try{this.setFocusableClass()}catch(e){V&&(V--,setTimeout(this.setFocusableClass,1e3))}}},mounted(){this.setFocusWatcher()},updated(){this.nativeTelInput||this.setFocusWatcher()}},void 0,!1,void 0,void 0,void 0);var A=s({render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("uploader",{staticClass:"fb-uploader fb-element",class:{"fb-uploader_disabled":e.isDisabled},attrs:{options:e.uploaderOptions},on:{"file-added":e.checkFile,"file-progress":e.setProgress,"file-success":e.addFileNameToForm,"upload-start":function(t){return e.toggleFormBlock(!0)},complete:function(t){return e.toggleFormBlock(!1)}}},[s("uploader-unsupport"),s("uploader-drop",[s("p",{staticClass:"fb-uploader__message"},[e._v(" "+e._s(e.$lang.FORMS_UPLOAD_DROP)+" "),s("span",{staticClass:"fb-uploader__fakebtn"},[e._v(e._s(e.$lang.FORMS_UPLOAD_ADD))]),s("uploader-btn",{ref:"uploaderBtn",staticClass:"fb-uploader__btn",attrs:{tabindex:"1"}},[s("span",[e._v(e._s(e.$lang.FORMS_UPLOAD_ADD))])])],1),e.format||e.size?s("p",[e.format?s("i",{staticClass:"fb-uploader__formats"},[e._v(" "+e._s(e.$lang.FORMS_UPLOAD_FORMAT)+" "+e._s(e.formatString)+". ")]):e._e(),e.size?s("i",{staticClass:"fb-uploader__size"},[e._v(" "+e._s(e.$lang.FORMS_UPLOAD_SIZE)+" "+e._s(e.size)+"Mb ")]):e._e()]):e._e()]),s("uploader-list",{scopedSlots:e._u([{key:"default",fn:function(t){return[e._t("list",[t.fileList.length?s("div",{staticClass:"fb-uploader__cwrap"},[s("table",{staticClass:"fb-uploader__list"},[s("tbody",[e._l(t.fileList,function(t,i){return[s("tr",{key:t.id},[s("td",{staticClass:"fb-uploader__list-number"},[e._v(e._s(i+1))]),s("td",{staticClass:"fb-uploader__list-name"},[s("span",{staticClass:"fb-uploader__list-ftitle"},[e._v(e._s(e.getName(t.name)))])]),s("td",{staticClass:"fb-uploader__list-type"},[e._v(e._s(e.getExtension(t.name)))]),s("td",{staticClass:"fb-uploader__list-size"},[e._v(e._s(e._f("bytesToMb")(t.size)))]),s("td",{staticClass:"fb-uploader__list-date"},[t.isComplete()?[e._v(" "+e._s(e._f("timestampToDate")(t._lastProgressCallback))+" ")]:e._e()],2),s("td",{staticClass:"fb-uploader__list-delete"},[s("button",{staticClass:"fb-uploader__delete",attrs:{title:e.$lang.FORMS_UPLOAD_DELETE,"aria-label":e.$lang.FORMS_UPLOAD_DELETE},on:{click:function(s){return s.preventDefault(),e.removeFile(t,i)}}},[e._v("Ã—")])])]),t.isComplete()?e._e():s("tr",{key:t.id+"loader",staticClass:"fb-uploader__list-pgwrap"},[s("td",{staticClass:"fb-uploader__list-progress",attrs:{colspan:"6"}},[s("progress",{staticClass:"fb-uploader__progress",attrs:{max:"1"},domProps:{value:e.filesProgress[t.uniqueIdentifier]}})])])]})],2)])]):e._e()],{fileList:t.fileList,removeFile:e.removeFile})]}}],null,!0)})],1)},staticRenderFns:[]},void 0,{name:"fb-uploader",mixins:[n],props:{url:{type:String,required:!0},format:{type:[String,Array]},size:[String,Number],validator:e=>+e==e},data:()=>({filesProgress:{}}),filters:{timestampToDate(e){let t=new Date(e);return`${t.getDate()}.${t.getMonth()+1}.${t.getFullYear()+1}`},bytesToMb(e){let t=e/1024/1024;return(t<1?t.toFixed(3):t.toFixed(1))+"Mb"}},computed:{uploaderOptions(){return{target:this.url,testChunks:!1}},formatArray(){return this.format&&Array.isArray(this.format)?this.format:this.format.split(",").map(e=>e.trim())},formatString(){return this.format&&Array.isArray(this.format)?this.format.concat(", "):this.format},maxSizeBytes(){return 1024*this.size*1024}},methods:{checkFile(e){this.format&&!this._extensionMatch(e)&&(e.ignored=!0,this.showError(this.$lang.FORMS_UPLOADER_EXTENSION_ERROR.replace("%s",e.name))),this.size&&e.size>this.maxSizeBytes&&(e.ignored=!0,this.showError(this.$lang.FORMS_UPLOADER_SIZE_ERROR.replace("%s",e.name)))},showError(e){AWES.notify({status:"error",message:e})},setProgress(e){this.$set(this.filesProgress,e.uniqueIdentifier,e.progress())},getExtension:e=>e.split(".").pop(),getName(e){let t=e.split(".");return t.pop(),t.join(".")},_extensionMatch(e){let t=this.getExtension(e.name);return this.formatArray.includes(t)},toggleFormBlock(e){this.$store.commit("setLoading",{formName:this.formId,status:e}),e||this.$forceUpdate()},addFileNameToForm(e,t,s,i){delete this.filesProgress[t.uniqueIdentifier];try{let e=JSON.parse(s),i=AWES.utils.object.get(e,"meta.path",t.relativePath);Array.isArray(this.formValue)?this.formValue.push(i):this.formValue=[i]}catch(e){console.log(e)}},removeFile(e,t){e.isComplete()&&this.formValue.splice(t,1),e.cancel(),delete this.filesProgress[e.uniqueIdentifier]},setFocus(e){this.__retries=this.__retries||20;try{let t=!1!==e?"focus":"blur";this.$refs.uploaderBtn.$el[t](),this.__retries=20}catch(t){this.__retries-=1,this.__retries&&setTimeout(()=>this.setFocus(e),1e3)}}}},void 0,!1,void 0,void 0,void 0);const I={branding:!1,statusbar:!1,menubar:!1,fontsize_formats:"10px 12px 14px 16px 18px 24px 36px",plugins:"lists",toolbar:["fontselect fontsizeselect bold italic underline numlist bullist"],setup:function(){this.on("ExecCommand",function(e){"FontName"===e.command&&(e.target.getDoc().body.style.fontFamily=e.value)})},init_instance_callback:function(){this.execCommand("FontName",!1,"Arial")}};const T={lineNumbers:!0,autoCloseBrackets:!0,matchBrackets:!0,autoCloseTags:!0,matchTags:!0,mode:"htmlmixed"};let N=0;var O=s({render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"fb-editor fb-element",class:[{"fb-editor_disabled":e.isDisabled}]},[s("div",{staticClass:"fb-editor__modes"},[s("button",{class:["fb-editor__modes-button",{"is-active":"visual"===e.mode}],attrs:{type:"button"},on:{click:function(t){e.mode="visual"}}},[e._v(" "+e._s(e.$lang.FORMS_EDITOR_VISUAL)+" ")]),s("button",{class:["fb-editor__modes-button",{"is-active":"code"===e.mode}],attrs:{type:"button"},on:{click:function(t){e.mode="code"}}},[e._v(" "+e._s(e.$lang.FORMS_EDITOR_CODE)+" ")])]),s("div",{staticClass:"fb-editor__tabs"},[s("div",{directives:[{name:"show",rawName:"v-show",value:"visual"===e.mode,expression:"mode === 'visual'"}],key:"visual",staticClass:"fb-editor__tab"},[s("textarea",{staticClass:"fb-editor__tiny",attrs:{id:e.editorId,disabled:e.isDisabled}},[e._v(e._s(e.formValue))])]),s("div",{directives:[{name:"show",rawName:"v-show",value:"code"===e.mode,expression:"mode === 'code'"}],key:"code",staticClass:"fb-editor__tab"},[s("textarea",{ref:"code",staticClass:"fb-editor__codemirror",attrs:{id:e.codeEditorId,disabled:e.isDisabled}},[e._v(e._s(e.formValue))])])])])},staticRenderFns:[]},void 0,{name:"fb-editor",mixins:[n],props:{options:{type:Object,default:()=>({})}},data:()=>({editorId:"fb-editor-"+N,codeEditorId:"fb-code-editor-"+N++,mode:"visual",codeEditorInited:!1}),watch:{mode(e){"visual"===e?(this._saveCode(),tinymce.get(this.editorId).setContent(this.value)):(this._saveVisual(),this.codeEditorInited?this._setCodeValue():AWES.utils.loadModules({codemirror:{src:["https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.43.0/codemirror.min.js","https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.43.0/codemirror.css"]},"codemirror-plugins":{deps:["codemirror"],src:["https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.43.0/mode/xml/xml.min.js","https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.43.0/addon/fold/xml-fold.min.js","https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.43.0/addon/edit/matchbrackets.min.js","https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.43.0/addon/edit/closebrackets.min.js","https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.43.0/addon/edit/matchtags.min.js","https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.43.0/addon/edit/closetag.min.js","https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.43.0/mode/htmlmixed/htmlmixed.min.js"]}}).then(this.initCodeEditor).then(this._setCodeValue))}},methods:{initEditor(){I.selector="#"+this.editorId;let e=AWES.utils.object.get(AWES._config,"formBuilder.fbEditor",{});this.focus&&(e.auto_focus=this.editorId),Object.assign(e,this.options,I),tinymce.init(e);const t=tinymce.get(this.editorId);t.on("Change",this._debounceSave),void 0!==typeof AWES._theme&&t.once("Init",()=>{this._switchThemeAttribute({detail:AWES._theme})})},initCodeEditor(){return this.codeEditorInited=!0,this._codeEditor=CodeMirror.fromTextArea(this.$refs.code,T),this._codeEditor.on("update",this._debounceSave),this._codeEditor},save(){"visual"===this.mode?this._saveVisual():this._saveCode()},_debounceSave(){clearTimeout(this._debounce),this._debounce=setTimeout(this.save,1e3)},_saveVisual(){this.formValue=tinymce.get(this.editorId).save()},_saveCode(){this._codeEditor&&(this.formValue=this._codeEditor.doc.getValue())},_setCodeValue(){this._codeEditor.doc.setValue(this.formValue),setTimeout(()=>{this._codeEditor.refresh()},1)},_switchThemeAttribute(e){const t=tinymce.get(this.editorId).getDoc();1===e.detail?t.documentElement.setAttribute("data-dark",!0):t.documentElement.removeAttribute("data-dark")},setFocus(e){try{!1!==e&&("visual"===this.mode?tinymce.get(this.editorId).focus():this._codeEditor&&this._codeEditor.focus())}catch(e){console.warn("Error while setting focus"),console.error(e)}}},mounted(){this.formId&&AWES.on(`form-builder::${this.formId}:before-send`,this.save),this.$nextTick(this.initEditor),void 0!==typeof AWES._theme&&AWES.on("theme.change",this._switchThemeAttribute)},beforeDestroy(){this.formId&&AWES.off(`form-builder::${this.formId}:before-send`,this.save),void 0!==typeof AWES._theme&&AWES.off("theme.change",this._switchThemeAttribute)}},void 0,!1,void 0,void 0,void 0);var M=s({render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{class:["fb-switcher","fb-element",{"fb-switcher_error":e.hasError,"fb-switcher_active":e.isActive,"fb-switcher_disabled":e.isDisabled}],on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"space",32,t.key,[" ","Spacebar"])?null:e.toggleValue(e.rangeValue)}}},[s("fb-error-wrap",{attrs:{open:e.showTooltip,error:e.error},on:{clickTooltip:e.clickTooltip}},[s("div",{staticClass:"fb-switcher__field-wrap",attrs:{"data-awes":e.$options.name+"."+e.name}},[s("input",e._g(e._b({ref:"element",staticClass:"fb-switcher__field",class:{"is-focusable":e.isFocusable,"in-focus":e.inFocus},attrs:{type:"range",min:"0",max:"1",step:"1",disabled:e.isDisabled},domProps:{value:e.rangeValue},on:{focus:function(t){e.inFocus=!0},blur:function(t){e.inFocus=!1},keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.focusNext(t))},mousedown:function(t){e.oldValue=e.rangeValue},click:function(t){return e.toggleValue(e.oldValue)}}},"input",e.$attrs,!1),{input:e.formId?e.formValueHandler:e.vModelHandler}))]),s("span",{staticClass:"fb-switcher__label",on:{click:function(t){return t.target!==t.currentTarget?null:e.toggleValue(e.rangeValue)}}},[e._v(e._s(e.label))])])],1)},staticRenderFns:[]},void 0,{name:"fb-switcher",inheritAttrs:!1,mixins:[m],data:()=>({oldValue:null}),computed:{rangeValue(){return Number(this.formId?this.formValue:this.vModelChecked)}},methods:{formValueHandler(e){this.oldValue=null;let t=+e.target.value;this.formValue=this.isNumeric?t:Boolean(t),this.error&&this.resetError()},vModelHandler(e){let t;this.oldValue=null,this.vModelArray?(t=this.value.slice(),e.target.value&&!this.vModelChecked?t.push(this.computedValue):!e.target.checked&&this.vModelChecked&&t.splice(t.findIndex(e=>e===this.computedValue),1)):t=Boolean(e.target.value),this.$emit("input",t)},toggleValue(e){if(this.isDisabled||null===e)return;let t={target:{value:e?0:1}};this.formId?this.formValueHandler(t):this.vModelHandler(t)}}},void 0,!1,void 0,void 0,void 0);var D={installed:!1,install:function(e){this.installed||(this.installed=!0,e.component("form-builder",i),e.component("fb-error-wrap",o),e.component("fb-switcher",M),e.component("fb-input",c),e.component("fb-multi-block",h),e.component("fb-checkbox",f),e.component("fb-select",b),e.component("fb-textarea",y),e.component("fb-code",k),e.component("fb-company-slug",e=>{AWES.utils.loadModule("urlify","https://unpkg.com/urlify@0.3.6/dist/urlify.js",()=>{e(F)})}),e.component("fb-auto-captcha",w),e.component("fb-radio-group",S),e.component("fb-slider",$),e.component("fb-phone",C),e.component("fb-uploader",e=>{AWES.utils.loadModule("vue-simple-uploader","https://unpkg.com/vue-simple-uploader@0.5.6/dist/vue-uploader.js",()=>{e(A)})}),e.component("fb-editor",e=>{AWES.utils.loadModules({"tiny-mce":"https://cdnjs.cloudflare.com/ajax/libs/tinymce/4.9.2/tinymce.min.js","tiny-mce-plugins":{deps:["tiny-mce"],src:["https://cdnjs.cloudflare.com/ajax/libs/tinymce/4.9.2/plugins/lists/plugin.min.js"]}}).then(()=>{e(O)})}))}},R={FORMS_SEND:"Send",FORMS_CANCEL:"Cancel",FORMS_LOADING:"Loading...",FORMS_CONFIRM:"Are you shure? All not submitted data will be erased...",FORMS_MULTIBLOCK_ADD:"+ add",FORMS_SELECT_LABEL:"Select a value",FORMS_SELECT_PLACEHOLDER:"Pick a value",FORMS_SELECT_AJAX_PLACEHOLDER:"Start typing...",FORMS_SELECT_EMPTY:"Nothing found",FORMS_SELECT_ADD_TAG:"Add new value",FORMS_UPLOAD_DROP:"Drag and drop file or",FORMS_UPLOAD_ADD:"Add file",FORMS_UPLOAD_FORMAT:"File formats only",FORMS_UPLOAD_SIZE:"Size of files no more then",FORMS_UPLOAD_REMOVE:"Remove file",FORMS_UPLOADER_EXTENSION_ERROR:"File %s has wrong extension",FORMS_UPLOADER_SIZE_ERROR:"File %s is too big",FORMS_EDITOR_VISUAL:"Visual",FORMS_EDITOR_CODE:"Code"};function L(e){e.isEdited||Vue.set(e,"isEdited",!0)}var j={state:()=>({}),getters:{form:e=>t=>e[t],fields:(e,t)=>e=>{let s={};const i=t.form(e);return i&&(s=i.fields),s},multiblockIds:(e,t)=>(e,s)=>{let i=[0];const o=t.form(e);return o&&(i=o.multiblocks[s].ids),i},errorsOrFalse:(e,t)=>e=>{const s=t.form(e);let i=s&&s.errors||{};return!AWES.utils.object.isEmpty(i)&&i},hasCaptchaError:(e,t)=>e=>{return!!t.form(e)["g-recaptcha-response"]},isLoading:(e,t)=>e=>{const s=t.form(e);return s&&s.isLoading},isMultiblockDisabled:(e,t)=>(e,s)=>{const i=t.form(name);return i&&!i.multiblocksDisabled[s]},fieldValue:(e,t)=>(e,s)=>{const i=t.form(e);return i&&i.fields[s]},fieldError:(e,t)=>(e,s)=>{const i=t.form(e);return i&&i.errors[s]},firstErrorField:e=>t=>e[t]&&e[t].firstErrorField},mutations:{createForm(e,{formName:t,fields:s}){Vue.set(e,t,{initialState:s,fields:{},errors:{},multiblocks:{},isLoading:!1,isEdited:!1,firstErrorField:null})},setLoading(e,{formName:t,status:s}){Vue.set(e[t],"isLoading",s)},deleteForm(e,t){Vue.delete(e,t)},setFormErrors(e,{formName:t,errors:s}){const i=e[t];Vue.set(i,"firstErrorField",Object.keys(s)[0]);let o={};for(let e in s){let t=s[e];o[r(e)]=t}Vue.set(i,"errors",o)},createField(e,{formName:t,fieldName:s,value:i}){const o=e[t];i=AWES.utils.object.get(o.initialState,s,i),Vue.set(o.fields,s,i)},setFieldValue(e,{formName:t,fieldName:s,value:i}){const o=e[t];Vue.set(o.fields,s,i),L(o)},deleteField(e,{formName:t,fieldName:s}){const i=e[t];Vue.delete(i.fields,s),Vue.delete(i.errors,s)},resetError(e,{formName:t,fieldName:s}){Vue.delete(e[t].errors,s)},resetErrors(e,t){Vue.set(e[t],"errors",{})},resetFirstErrorField(e,t){Vue.set(e[t],"firstErrorField",null)},createMutiblock(e,{formName:t,multiblockName:s,disabled:i}){const o=e[t],{get:r,isEmpty:a}=AWES.utils.object;let l=r(o.initialState,s);l=a(l)?[{}]:l;let n=Object.keys(l).map(e=>Number(e));Vue.set(o.multiblocks,s,{disabled:i,ids:n})},deleteMutiblock(e,{formName:t,multiblockName:s}){Vue.delete(e[t].multiblocks,s)},toggleMultiblockState(e,{formName:t,multiblockName:s,status:i}){Vue.set(e[t].multiblocks[s],"disabled",i)},addMultiblockId(e,{formName:t,multiblockName:s,id:i}){const o=e[t];o.multiblocks[s].ids.push(i),L(o)},deleteMultiblockId(e,{formName:t,multiblockName:s,id:i}){const o=e[t];let r=o.multiblocks[s].ids,a=r.findIndex(e=>e===i);r.splice(a,1),L(o)}},actions:{restoreData({state:e},{formName:t}){const s=e[t],i=function(e,t=null){let s={};for(let i in e){let o=t?t(e[i]):e[i];AWES.utils.object.set(s,i,o)}return s}(s.fields),o=Object.keys(s.multiblocks);if(o.length){!function(e,t){const{get:s,set:i}=AWES.utils.object;t.forEach(t=>{let o=s(e,t);i(e,t,function(e){return e.filter(()=>!0)}(o))})}(i,o);for(let e of o){let t=Object.keys(AWES.utils.object.get(i,e,[{}])).map(e=>Number(e));Vue.set(s.multiblocks[e],"ids",t)}}return i},sendForm:({state:e,commit:t,dispatch:s},{formName:i,url:o,method:r})=>new Promise(a=>{let l;const n=e[i];t("resetErrors",i),t("setLoading",{formName:i,status:!0}),s("restoreData",{formName:i}).then(e=>AWES.ajax(e,o,r)).then(e=>{if(l=e,e.success){let t=e.data.data||{};Vue.set(n,"initialState",t);let s={};for(let e in n.fields)s[e]=AWES.utils.object.get(t,e);Vue.set(n,"fields",s),Vue.set(n,"isEdited",!1)}else e.data&&t("setFormErrors",{formName:i,errors:e.data})}).finally(()=>{t("setLoading",{formName:i,status:!1}),a(l)})})},namespaced:!0};const W={name:"form-builder",version:"1.3.22",modules:{"vue-shortkey":{src:"https://unpkg.com/vue-shortkey/dist/index.js",deps:["vue"],cb(){Vue.use(VueShortkey)}},"v-tooltip":{src:"https://unpkg.com/v-tooltip/dist/v-tooltip.min.js",deps:["vue"],cb(){VTooltip.default.options.popover=Object.assign(VTooltip.default.options.popover,{defaultPlacement:"right",defaultAutoHide:!1,defaultTrigger:"manual",defaultPopperOptions:{modifiers:{flip:{behavior:["right","top"]}}}})}},"vue-the-mask":{src:"https://unpkg.com/vue-the-mask@0.11.1/dist/vue-the-mask.js",deps:["vue"]}},install(e){Vue.use(D),e._store.registerModule("forms",j),e.lang=R}};window&&"AWES"in window?AWES.use(W):(window.__awes_plugins_stack__=window.__awes_plugins_stack__||[],window.__awes_plugins_stack__.push(W))}();
